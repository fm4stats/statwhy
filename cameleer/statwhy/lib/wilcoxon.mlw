module Wilcoxon
  use cameleerBHL.CameleerBHL

  val exec_wilcoxon (p1 : population) (p2 : population) (y : dataset (list real, list real)) : real
  writes { st }
  requires {
    match y with
    | (y1, y2) ->
      sampled y1 p1 /\ sampled y2 p2 /\
      paired y1 y2 /\
      (World !st interp) |= Possible (p1 $!=^ p2)
    end
  } ensures {
    let pv = result in
    pvalue result /\
    !st = Cons ("wilcoxon", (p1 $!=^ p2), Eq pv) !(old st)
  }
end
